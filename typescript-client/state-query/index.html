<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.76.5"><meta name=description content="User manual for Ogmios, a lightweight protocol translation service for Cardano."><meta name=author content="KtorZ <matthias.benkort@gmail.com>"><link rel=icon href=/images/favicon.png type=image/png><title>StateQuery Client - Ogmios</title><link href=/css/nucleus.css?1666869641 rel=stylesheet><link href=/css/fontawesome-all.min.css?1666869641 rel=stylesheet><link href=/css/hybrid.css?1666869641 rel=stylesheet><link href=/css/featherlight.min.css?1666869641 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1666869641 rel=stylesheet><link href=/css/auto-complete.css?1666869641 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1666869641 rel=stylesheet><link href=/css/theme.css?1666869641 rel=stylesheet><link href=/css/tabs.css?1666869641 rel=stylesheet><link href=/css/hugo-theme.css?1666869641 rel=stylesheet><link href=/css/theme-mine.css?1666869641 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1666869641></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/typescript-client/state-query/><nav id=sidebar><div id=header-wrapper><div id=header><a href=/><img alt=ogmios src=/ogmios-logo-white.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1666869641></script><script type=text/javascript src=/js/auto-complete.js?1666869641></script><script type=text/javascript>var baseurl="https:\/\/ogmios.dev";</script><script type=text/javascript src=/js/search.js?1666869641></script></div><div class=highlightable><ul class=topics><li data-nav-id=/getting-started/ title="Getting Started" class=dd-item><a href=/getting-started/><b>1. </b>Getting Started</a><ul><li data-nav-id=/getting-started/docker/ title=Docker class=dd-item><a href=/getting-started/docker/>Docker</a></li><li data-nav-id=/getting-started/building/ title=Building class=dd-item><a href=/getting-started/building/>Building</a></li><li data-nav-id=/getting-started/testing/ title=Testing class=dd-item><a href=/getting-started/testing/>Testing</a></li><li data-nav-id=/getting-started/monitoring/ title=Monitoring class=dd-item><a href=/getting-started/monitoring/>Monitoring</a></li><li data-nav-id=/getting-started/basics/ title=Basics class=dd-item><a href=/getting-started/basics/>Basics</a></li></ul></li><li data-nav-id=/mini-protocols/ title="Ouroboros Mini-Protocols" class=dd-item><a href=/mini-protocols/><b>2. </b>Ouroboros Mini-Protocols</a><ul><li data-nav-id=/mini-protocols/local-chain-sync/ title="Local Chain Sync" class=dd-item><a href=/mini-protocols/local-chain-sync/>Local Chain Sync</a></li><li data-nav-id=/mini-protocols/local-state-query/ title="Local State Query" class=dd-item><a href=/mini-protocols/local-state-query/>Local State Query</a></li><li data-nav-id=/mini-protocols/local-tx-submission/ title="Local Tx Submission" class=dd-item><a href=/mini-protocols/local-tx-submission/>Local Tx Submission</a></li><li data-nav-id=/mini-protocols/local-tx-monitor/ title="Local Tx Monitor" class=dd-item><a href=/mini-protocols/local-tx-monitor/>Local Tx Monitor</a></li></ul></li><li data-nav-id=/deployment/ title=Deployment class=dd-item><a href=/deployment/><b>4. </b>Deployment</a><ul><li data-nav-id=/deployment/aws/ title=AWS class=dd-item><a href=/deployment/aws/>AWS</a></li></ul></li><li data-nav-id=/typescript-client/ title="TypeScript Client" class="dd-item
parent"><a href=/typescript-client/><b>4. </b>TypeScript Client</a><ul><li data-nav-id=/typescript-client/overview/ title=Overview class=dd-item><a href=/typescript-client/overview/>Overview</a></li><li data-nav-id=/typescript-client/chain-sync/ title="ChainSync Client" class=dd-item><a href=/typescript-client/chain-sync/>ChainSync Client</a></li><li data-nav-id=/typescript-client/state-query/ title="StateQuery Client" class="dd-item active"><a href=/typescript-client/state-query/>StateQuery Client</a></li><li data-nav-id=/typescript-client/tx-submission/ title="TxSubmission Client" class=dd-item><a href=/typescript-client/tx-submission/>TxSubmission Client</a></li><li data-nav-id=/typescript-client/tx-monitor/ title="TxMonitor Client" class=dd-item><a href=/typescript-client/tx-monitor/>TxMonitor Client</a></li></ul></li><li data-nav-id=/api/ title="API Reference" class=dd-item><a href=/api/><b>5. </b>API Reference</a></li><li data-nav-id=/changelog/ title=Changelog class=dd-item><a href=/changelog/><b>6. </b>Changelog</a></li><li data-nav-id=/faq/ title=F.A.Q class=dd-item><a href=/faq/><b>7. </b>F.A.Q</a></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/cardanosolutions/ogmios><i class="fab fa-github"></i>Source code</a></li><li><a class=padding href=https://github.com/cardanosolutions/ogmios/issues><i class="fab fa-solid fa-bullseye"></i>Issues Tracking</a></li><li><a class=padding href=https://discord.gg/ZeyDn65t5v><i class="fab fa-discord"></i>Discord (#ogmios)</a></li><li><a class=padding href=https://github.com/CardanoSolutions/ogmios/tree/master/architectural-decisions/accepted><i class="fab fa-solid fa-file-code"></i>Architectural Decisions Record</a></li></ul></section><section id=footer><style>i.fa-solid{margin-left:-2px!important;margin-right:-2px!important}</style></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span><span class=links><a href=/>Overview</a> > <a href=/typescript-client/>TypeScript Client</a> > StateQuery Client</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#acquire-a-specific-point>Acquire a specific point</a></li></ul></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>StateQuery Client</h1><p>The StateQuery client allows you to play with the <a href=/mini-protocols/local-state-query>Local State Query</a> mini protocol; that is, a protocol for querying parts of the ledger state. The complete set of queries is described in <a href=https://ogmios.dev/typescript/api/modules/_cardano_ogmios_client.StateQuery.html>API reference</a>. To use it, create a client from a context and start querying!</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>createStateQueryClient</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@cardano-ogmios/client&#39;</span>

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>client</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>createStateQueryClient</span>(<span style=color:#a6e22e>context</span>)

<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`ledgerTip: </span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>await</span> <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>ledgerTip</span>()).<span style=color:#a6e22e>tip</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
<span style=color:#75715e>// ledgerTip: {&#34;slot&#34;:33055551,&#34;hash&#34;:&#34;050b05030645fdc4ee10e81f131030049c08f7763355873564540fe5a0533f43&#34;}
</span><span style=color:#75715e></span>
<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`currentEpoch: </span><span style=color:#e6db74>${</span><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>currentEpoch</span>()<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
<span style=color:#75715e>// currentEpoch: 146
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>await</span> <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>shutdown</span>() <span style=color:#75715e>// Close the connection when done.
</span></code></pre></div><h3 id=acquire-a-specific-point>Acquire a specific point</h3><p>By default, the client will acquire the current tip of the blockchain and <strong>run all subsequent queries</strong> from that point. This makes it possible to get somewhat consistent data when running multiple queries. You can specify which point you want to acquire by providing an extra argument when constructing the client.</p><p>For example (notice how the <code>ledgerTip</code> remains unchanged, and equal to the acquired point!):</p><pre><code>import delay from 'delay'
import { createStateQueryClient } from '@cardano-ogmios/client'

const point = {
  slot: 33055551,
  hash: '050b05030645fdc4ee10e81f131030049c08f7763355873564540fe5a0533f43'
}
const client = await createStateQueryClient(context, { point })

console.log(`ledgerTip: ${await client.ledgerTip().tip}`)
// ledgerTip: {&quot;slot&quot;:33055551,&quot;hash&quot;:&quot;050b05030645fdc4ee10e81f131030049c08f7763355873564540fe5a0533f43&quot;}

delay(5000)

console.log(`ledgerTip: ${await client.ledgerTip().tip}`)
// ledgerTip: {&quot;slot&quot;:33055551,&quot;hash&quot;:&quot;050b05030645fdc4ee10e81f131030049c08f7763355873564540fe5a0533f43&quot;}
</code></pre><div class="notices info"><p>You cannot acquire points that are <em>too old</em> on the blockchain. Too old may be a bit tricky to define but a good rule of thumb is: anything older than 64800 slots is too old (i.e. <code>3k/f</code>).</p></div><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/typescript-client/chain-sync/ title="ChainSync Client"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/typescript-client/tx-submission/ title="TxSubmission Client" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1666869641></script><script src=/js/perfect-scrollbar.min.js?1666869641></script><script src=/js/perfect-scrollbar.jquery.min.js?1666869641></script><script src=/js/jquery.sticky.js?1666869641></script><script src=/js/featherlight.min.js?1666869641></script><script src=/js/highlight.pack.js?1666869641></script><script>hljs.initHighlightingOnLoad();</script><script src=/js/modernizr.custom-3.6.0.js?1666869641></script><script src=/js/learn.js?1666869641></script><script src=/js/hugo-learn.js?1666869641></script></body></html>